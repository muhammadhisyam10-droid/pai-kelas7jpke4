<!-- Chosen Palette: Midnight Santri (Background: #0f172a [Slate 900], Text: #f8fafc [Slate 50], Accents: #fbbf24 [Amber 400], Primary: #38bdf8 [Sky 400]) -->

<!-- Application Structure Plan:
    1. **Hero Section**: "Lelah Lillah". Hooks the tired student immediately by validating their struggle and connecting it to the reward (Akhirat).
    2. **Dalil Explorer**: Interactive cards for Q.S. Ali-Imran 102, Luqman 33, and Hadith. Users toggle between Arabic, Translation, and 'Inti Sari' (Essence) to reduce cognitive load.
    3. **Concept Visualization (Radar Chart)**: Visualizes Wahbah Zuhailiy's definition of Takwa + Hadith components as a 5-point radar chart. This turns abstract theology into a concrete "profile" to strive for.
    4. **Tajwid & Language Focus**: A specific interactive section for 'Gunnah' identification and vocabulary (Mufrodat), directly addressing the learning objectives in the PDF.
    5. **Life Scenarios (Studi Kasus)**: Interactive buttons representing daily santri dilemmas (sleepy, peer pressure). Clicking reveals the 'Takwa Response' vs 'Ghurur Response'.
    6. **Gamified Quiz**: 10 Questions drawn from the generated quiz data. Instant feedback with color-coded rationale.
    *Rationale*: This flow moves from Motivation -> Knowledge -> Analysis -> Practice -> Assessment.
-->

<!-- Visualization & Content Choices:
    1. **Radar Chart (Chart.js)**:
       - Goal: Visualize the multifaceted nature of Takwa (not just prayer, but social & internal).
       - Interaction: Hover to see descriptions. Comparison between "Ideal" vs "Reality".
       - Justification: Shows balance is key.
    2. **Scenario Cards**:
       - Goal: Apply Q.S. Luqman 33 (Do not be deceived) to daily life.
       - Interaction: Click to reveal consequences.
       - Justification: Bridges the gap between ancient text and modern boarding school life.
    3. **Tajwid Selector**:
       - Goal: Practice spotting Gunnah.
       - Interaction: Multiple choice button grid.
       - Justification: Meets specific cognitive goal from source PDF.
-->

<!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->

<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modul Interaktif: Takwa & Hari Akhir</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Amiri&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #0f172a; /* Slate 900 */
            color: #f1f5f9; /* Slate 100 */
        }
        .font-arabic {
            font-family: 'Amiri', serif;
            line-height: 2.2;
        }
        .glass-panel {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 500px;
            height: 400px;
            margin: 0 auto;
        }
        .active-tab {
            background-color: #fbbf24; /* Amber 400 */
            color: #0f172a;
            font-weight: bold;
        }
        .inactive-tab {
            background-color: rgba(255, 255, 255, 0.1);
            color: #94a3b8;
        }
        /* Custom scrollbar for text areas */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #1e293b; 
        }
        ::-webkit-scrollbar-thumb {
            background: #475569; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #64748b; 
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- Header -->
    <header class="sticky top-0 z-50 bg-slate-900/90 backdrop-blur border-b border-slate-700 shadow-lg">
        <div class="max-w-6xl mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 bg-gradient-to-br from-sky-500 to-blue-600 rounded-full flex items-center justify-center text-white font-bold shadow-lg shadow-sky-500/30">
                    MU
                </div>
                <div>
                    <h1 class="font-bold text-lg leading-tight text-white">PAI Kelas 7</h1>
                    <p class="text-xs text-sky-400 font-medium">SMP Manbaul Ulum</p>
                </div>
            </div>
            <div class="hidden md:flex gap-4 text-sm font-medium text-slate-300">
                <a href="#dalil" class="hover:text-amber-400 transition">Dalil</a>
                <a href="#konsep" class="hover:text-amber-400 transition">Konsep</a>
                <a href="#aplikasi" class="hover:text-amber-400 transition">Aplikasi</a>
                <a href="#kuis" class="hover:text-amber-400 transition">Kuis</a>
            </div>
            <button onclick="document.getElementById('kuis').scrollIntoView({behavior: 'smooth'})" class="md:hidden bg-amber-500 text-slate-900 text-xs font-bold px-3 py-1.5 rounded-full">
                Mulai Kuis
            </button>
        </div>
    </header>

    <main class="flex-grow max-w-5xl mx-auto px-4 py-8 space-y-16">

        <!-- HERO SECTION -->
        <section class="text-center space-y-6 animate-fade-in py-10">
            <div class="inline-block px-4 py-1.5 bg-slate-800 rounded-full border border-slate-700 mb-2">
                <span class="text-amber-400 text-xs font-bold uppercase tracking-wider">Bab 1: Takwa & Hari Akhir</span>
            </div>
            <h2 class="text-4xl md:text-6xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-sky-400 via-white to-amber-400 pb-2">
                Lelahmu Jadi Lillah
            </h2>
            <p class="text-slate-400 text-lg max-w-2xl mx-auto leading-relaxed">
                Mengantuk itu manusiawi, tapi menuntut ilmu adalah jalan menuju surga. Mari kita pelajari bagaimana <strong>Kesadaran Hari Akhir</strong> menjadi "baterai" saat energi kita habis.
            </p>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 max-w-3xl mx-auto mt-8">
                <div class="glass-panel p-4 rounded-xl text-center">
                    <div class="text-2xl mb-1">ğŸ¤²</div>
                    <div class="text-xs font-bold text-slate-300">Kepatuhan</div>
                </div>
                <div class="glass-panel p-4 rounded-xl text-center">
                    <div class="text-2xl mb-1">ğŸ‘ï¸</div>
                    <div class="text-xs font-bold text-slate-300">Muraqabah</div>
                </div>
                <div class="glass-panel p-4 rounded-xl text-center">
                    <div class="text-2xl mb-1">ğŸš§</div>
                    <div class="text-xs font-bold text-slate-300">Rem Dosa</div>
                </div>
                <div class="glass-panel p-4 rounded-xl text-center">
                    <div class="text-2xl mb-1">â›½</div>
                    <div class="text-xs font-bold text-slate-300">Gas Ibadah</div>
                </div>
            </div>
        </section>

        <!-- DALIL EXPLORER -->
        <section id="dalil" class="scroll-mt-24">
            <div class="mb-6 border-l-4 border-sky-500 pl-4">
                <h3 class="text-2xl font-bold text-white">1. Sumber Hukum (Dalil)</h3>
                <p class="text-slate-400 mt-1">Klik tombol di bawah untuk menggali makna ayat.</p>
            </div>

            <div class="grid md:grid-cols-2 gap-6">
                <!-- Ayat 1 -->
                <div class="glass-panel rounded-2xl overflow-hidden flex flex-col">
                    <div class="bg-slate-800/50 p-4 border-b border-slate-700 flex justify-between items-center">
                        <span class="font-bold text-sky-400">Q.S. Ali-Imran: 102</span>
                        <span class="text-xs bg-sky-900/50 text-sky-200 px-2 py-1 rounded">Perintah Takwa</span>
                    </div>
                    <div class="p-6 flex-grow flex flex-col gap-4">
                        <div id="dalil-1-content" class="text-center">
                            <p class="font-arabic text-2xl md:text-3xl text-amber-400 mb-4">ÙŠÙÙ°Ù“Ø£ÙÙŠÙ‘ÙÙ‡ÙØ§ Ù±Ù„Ù‘ÙØ°ÙÙŠÙ†Ù Ø¡ÙØ§Ù…ÙÙ†ÙÙˆØ§ÛŸ Ù±ØªÙ‘ÙÙ‚ÙÙˆØ§ÛŸ Ù±Ù„Ù„Ù‘ÙÙ‡Ù Ø­ÙÙ‚Ù‘Ù ØªÙÙ‚ÙØ§ØªÙÙ‡ÙÛ¦ ÙˆÙÙ„ÙØ§ ØªÙÙ…ÙÙˆØªÙÙ†Ù‘Ù Ø¥ÙÙ„Ù‘ÙØ§ ÙˆÙØ£ÙÙ†ØªÙÙ… Ù…Ù‘ÙØ³Ù’Ù„ÙÙ…ÙÙˆÙ†Ù</p>
                            <p class="text-slate-300 italic text-sm">"Wahai orang-orang yang beriman! Bertakwalah kepada Allah dengan sebenar-benar takwa kepada-Nya dan janganlah kamu mati kecuali dalam keadaan Muslim."</p>
                        </div>
                    </div>
                    <div class="bg-slate-800 p-3 grid grid-cols-3 gap-2 text-xs">
                        <button onclick="updateDalil(1, 'arab')" class="dalil-btn-1 bg-slate-700 hover:bg-slate-600 py-2 rounded text-white font-medium transition">Arab & Arti</button>
                        <button onclick="updateDalil(1, 'tajwid')" class="dalil-btn-1 bg-slate-700 hover:bg-slate-600 py-2 rounded text-white font-medium transition">Tajwid</button>
                        <button onclick="updateDalil(1, 'inti')" class="dalil-btn-1 bg-slate-700 hover:bg-slate-600 py-2 rounded text-white font-medium transition">Inti Sari</button>
                    </div>
                </div>

                <!-- Ayat 2 -->
                <div class="glass-panel rounded-2xl overflow-hidden flex flex-col">
                    <div class="bg-slate-800/50 p-4 border-b border-slate-700 flex justify-between items-center">
                        <span class="font-bold text-amber-400">Q.S. Luqman: 33</span>
                        <span class="text-xs bg-amber-900/50 text-amber-200 px-2 py-1 rounded">Peringatan Kiamat</span>
                    </div>
                    <div class="p-6 flex-grow flex flex-col gap-4">
                        <div id="dalil-2-content" class="text-center">
                            <p class="font-arabic text-2xl md:text-3xl text-sky-300 mb-4">...ÙˆÙØ§Ø®Ù’Ø´ÙÙˆÙ’Ø§ ÙŠÙÙˆÙ’Ù…Ù‹Ø§ Ù„Ù‘ÙØ§ ÙŠÙØ¬Ù’Ø²ÙÙŠ ÙˆÙØ§Ù„ÙØ¯ÙŒ Ø¹ÙÙ† ÙˆÙÙ„ÙØ¯ÙÙ‡Ù... ÙÙÙ„ÙØ§ ØªÙØºÙØ±Ù‘ÙÙ†Ù‘ÙÙƒÙÙ…Ù Ø§Ù„Ù’Ø­ÙÙŠÙØ§Ø©Ù Ø§Ù„Ø¯Ù‘ÙÙ†Ù’ÙŠÙØ§...</p>
                            <p class="text-slate-300 italic text-sm">"...dan takutlah pada suatu hari yang (pada hari itu) seorang bapak tidak dapat menolong anaknya... maka janganlah sekali-kali kamu diperdaya oleh kehidupan dunia..."</p>
                        </div>
                    </div>
                    <div class="bg-slate-800 p-3 grid grid-cols-3 gap-2 text-xs">
                        <button onclick="updateDalil(2, 'arab')" class="dalil-btn-2 bg-slate-700 hover:bg-slate-600 py-2 rounded text-white font-medium transition">Arab & Arti</button>
                        <button onclick="updateDalil(2, 'mufrodat')" class="dalil-btn-2 bg-slate-700 hover:bg-slate-600 py-2 rounded text-white font-medium transition">Mufrodat</button>
                        <button onclick="updateDalil(2, 'inti')" class="dalil-btn-2 bg-slate-700 hover:bg-slate-600 py-2 rounded text-white font-medium transition">Inti Sari</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- CONCEPT VISUALIZATION (RADAR CHART) -->
        <section id="konsep" class="scroll-mt-24 grid md:grid-cols-5 gap-8">
            <div class="md:col-span-2 space-y-4">
                <div class="border-l-4 border-amber-500 pl-4">
                    <h3 class="text-2xl font-bold text-white">2. Dimensi Takwa</h3>
                    <p class="text-slate-400 mt-1">Definisi menurut Wahbah Zuhailiy & Hadis Nabi.</p>
                </div>
                <div class="glass-panel p-5 rounded-xl space-y-4 text-sm">
                    <p class="text-slate-300">Grafik di samping menunjukkan 5 sisi keseimbangan seorang Santri yang bertakwa. Takwa bukan hanya shalat!</p>
                    <ul class="space-y-3">
                        <li class="flex items-start gap-3">
                            <span class="bg-sky-500/20 text-sky-400 p-1 rounded">1</span>
                            <div><strong class="text-white">Kepatuhan:</strong> Melaksanakan perintah & menjauhi larangan.</div>
                        </li>
                        <li class="flex items-start gap-3">
                            <span class="bg-sky-500/20 text-sky-400 p-1 rounded">2</span>
                            <div><strong class="text-white">Syukur:</strong> Menggunakan nikmat untuk taat, bukan maksiat.</div>
                        </li>
                        <li class="flex items-start gap-3">
                            <span class="bg-sky-500/20 text-sky-400 p-1 rounded">3</span>
                            <div><strong class="text-white">Dzikir:</strong> Selalu ingat Allah (Muraqabah).</div>
                        </li>
                        <li class="flex items-start gap-3">
                            <span class="bg-sky-500/20 text-sky-400 p-1 rounded">4</span>
                            <div><strong class="text-white">Ihsan:</strong> Menghapus dosa dengan amal baik.</div>
                        </li>
                         <li class="flex items-start gap-3">
                            <span class="bg-sky-500/20 text-sky-400 p-1 rounded">5</span>
                            <div><strong class="text-white">Akhlak:</strong> Berbuat baik kepada sesama manusia.</div>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="md:col-span-3 glass-panel rounded-2xl p-4 flex items-center justify-center bg-slate-800/30">
                <div class="chart-container">
                    <canvas id="takwaRadar"></canvas>
                </div>
            </div>
        </section>

        <!-- TAJWID & LANGUAGE GAME -->
        <section id="tajwid" class="scroll-mt-24">
            <div class="glass-panel rounded-2xl p-6 border border-slate-600">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4">
                    <div>
                        <h3 class="text-xl font-bold text-white flex items-center gap-2">
                            <span class="text-2xl">ğŸ”</span> Detektif Tajwid: Gunnah
                        </h3>
                        <p class="text-slate-400 text-sm">Temukan kata yang mengandung bacaan Gunnah (Nun/Mim bertasydid).</p>
                    </div>
                    <div class="text-right">
                        <span id="tajwid-score" class="text-2xl font-bold text-emerald-400">0</span>
                        <span class="text-slate-500 text-sm">/ 3 Benar</span>
                    </div>
                </div>

                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <button onclick="checkTajwid(this, false)" class="tajwid-opt p-4 rounded-xl bg-slate-800 hover:bg-slate-700 border border-slate-700 text-center transition group">
                        <div class="font-arabic text-xl mb-2 group-hover:text-white">ÙˆÙØ§Ø®Ù’Ø´ÙÙˆÙ’Ø§</div>
                        <div class="text-xs text-slate-500">(Mad Layyin)</div>
                    </button>
                    <button onclick="checkTajwid(this, true)" class="tajwid-opt p-4 rounded-xl bg-slate-800 hover:bg-slate-700 border border-slate-700 text-center transition group">
                        <div class="font-arabic text-xl mb-2 group-hover:text-white">ØªÙØºÙØ±Ù‘ÙÙ†Ù‘ÙÙƒÙÙ…Ù</div>
                        <div class="text-xs text-slate-500">(Nun Tasydid)</div>
                    </button>
                    <button onclick="checkTajwid(this, false)" class="tajwid-opt p-4 rounded-xl bg-slate-800 hover:bg-slate-700 border border-slate-700 text-center transition group">
                        <div class="font-arabic text-xl mb-2 group-hover:text-white">ÙˆÙØ§Ù„ÙØ¯ÙŒ</div>
                        <div class="text-xs text-slate-500">(Mad Thabi'i)</div>
                    </button>
                    <button onclick="checkTajwid(this, true)" class="tajwid-opt p-4 rounded-xl bg-slate-800 hover:bg-slate-700 border border-slate-700 text-center transition group">
                        <div class="font-arabic text-xl mb-2 group-hover:text-white">Ø¥ÙÙ†Ù‘Ù Ù±Ù„Ù„Ù‘ÙÙ‡Ù</div>
                        <div class="text-xs text-slate-500">(Nun Tasydid)</div>
                    </button>
                </div>
                <div id="tajwid-feedback" class="mt-4 text-center text-sm font-bold min-h-[20px]"></div>
            </div>
        </section>

        <!-- LIFE SCENARIOS (APLIKASI) -->
        <section id="aplikasi" class="scroll-mt-24 space-y-6">
            <div class="text-center">
                <h3 class="text-2xl font-bold text-white">3. Studi Kasus Santri</h3>
                <p class="text-slate-400">Pilih situasi yang sering kamu alami di pondok.</p>
            </div>

            <div class="grid md:grid-cols-3 gap-6">
                <!-- Scenario 1 -->
                <div class="glass-panel p-6 rounded-2xl hover:border-sky-500 transition cursor-pointer group" onclick="openModal('ngantuk')">
                    <div class="w-12 h-12 bg-slate-700 rounded-full flex items-center justify-center text-2xl mb-4 group-hover:bg-sky-600 transition">ğŸ˜´</div>
                    <h4 class="font-bold text-lg text-slate-200 mb-2">Ngantuk Berat Saat Ngaji</h4>
                    <p class="text-sm text-slate-400">Ustaz sedang menjelaskan, tapi matamu berat sekali...</p>
                    <div class="mt-4 text-xs font-bold text-sky-400 uppercase tracking-wide">Lihat Respon Takwa &rarr;</div>
                </div>

                <!-- Scenario 2 -->
                <div class="glass-panel p-6 rounded-2xl hover:border-amber-500 transition cursor-pointer group" onclick="openModal('uang')">
                    <div class="w-12 h-12 bg-slate-700 rounded-full flex items-center justify-center text-2xl mb-4 group-hover:bg-amber-600 transition">ğŸ’°</div>
                    <h4 class="font-bold text-lg text-slate-200 mb-2">Nemu Uang 50 Ribu</h4>
                    <p class="text-sm text-slate-400">Di lorong sepi, tidak ada CCTV, tidak ada yang lihat...</p>
                    <div class="mt-4 text-xs font-bold text-amber-400 uppercase tracking-wide">Lihat Respon Takwa &rarr;</div>
                </div>

                <!-- Scenario 3 -->
                <div class="glass-panel p-6 rounded-2xl hover:border-red-500 transition cursor-pointer group" onclick="openModal('teman')">
                    <div class="w-12 h-12 bg-slate-700 rounded-full flex items-center justify-center text-2xl mb-4 group-hover:bg-red-600 transition">ğŸ®</div>
                    <h4 class="font-bold text-lg text-slate-200 mb-2">Diajak Kabur Teman</h4>
                    <p class="text-sm text-slate-400">"Ayo keluar sebentar, Ustaz gak bakal tahu kok..."</p>
                    <div class="mt-4 text-xs font-bold text-red-400 uppercase tracking-wide">Lihat Respon Takwa &rarr;</div>
                </div>
            </div>
        </section>

        <!-- QUIZ SECTION -->
        <section id="kuis" class="scroll-mt-24 pt-8 border-t border-slate-800">
            <div class="flex flex-col md:flex-row justify-between items-end mb-6 gap-4">
                <div>
                    <h3 class="text-3xl font-bold text-white">Kuis Pemahaman</h3>
                    <p class="text-slate-400">Buktikan kamu tidak mengantuk! Jawab 10 soal ini.</p>
                </div>
                <div class="bg-slate-800 px-4 py-2 rounded-lg border border-slate-700">
                    <span class="text-sm text-slate-400">Skor Kamu:</span>
                    <span id="quiz-score" class="text-2xl font-bold text-amber-400 ml-2">0</span>
                </div>
            </div>

            <div class="glass-panel rounded-2xl p-6 md:p-8 min-h-[400px] relative">
                <!-- Question Container -->
                <div id="quiz-container">
                    <div class="flex justify-between items-center mb-6">
                        <span id="question-number" class="text-xs font-bold bg-sky-900 text-sky-200 px-2 py-1 rounded">Soal 1/10</span>
                        <div class="h-2 flex-grow mx-4 bg-slate-700 rounded-full overflow-hidden">
                            <div id="progress-bar" class="h-full bg-amber-400 w-1/10 transition-all duration-300"></div>
                        </div>
                    </div>
                    
                    <h4 id="question-text" class="text-xl md:text-2xl font-medium text-white mb-8 leading-relaxed">Loading...</h4>
                    
                    <div id="answer-grid" class="grid gap-3">
                        <!-- Buttons generated by JS -->
                    </div>

                    <div id="rationale-box" class="hidden mt-6 p-4 rounded-xl border bg-slate-800/80 animate-fade-in">
                        <h5 id="rationale-title" class="font-bold mb-1"></h5>
                        <p id="rationale-text" class="text-sm text-slate-300"></p>
                        <button onclick="nextQuestion()" class="mt-4 bg-sky-600 hover:bg-sky-500 text-white px-6 py-2 rounded-lg font-bold text-sm transition">Lanjut &rarr;</button>
                    </div>
                </div>

                <!-- End Screen -->
                <div id="quiz-end" class="hidden text-center py-10">
                    <div class="text-6xl mb-4">ğŸ‰</div>
                    <h3 class="text-3xl font-bold text-white mb-2">Selesai!</h3>
                    <p class="text-slate-400 mb-6">Kamu telah menyelesaikan modul ini.</p>
                    <div class="text-5xl font-bold text-amber-400 mb-8" id="final-score">0</div>
                    <button onclick="restartQuiz()" class="bg-slate-700 hover:bg-slate-600 text-white px-8 py-3 rounded-xl font-bold transition">Coba Lagi</button>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="text-center py-8 text-slate-600 text-sm">
            <p>SMP Manbaul Ulum &copy; 2024</p>
            <p class="mt-2 text-xs">"Barangsiapa bertakwa kepada Allah niscaya Dia akan mengadakan baginya jalan keluar."</p>
        </footer>

    </main>

    <!-- Modal for Scenarios -->
    <div id="modal-overlay" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 hidden flex items-center justify-center p-4">
        <div class="bg-slate-800 w-full max-w-lg rounded-2xl border border-slate-600 shadow-2xl overflow-hidden transform scale-95 opacity-0 transition-all duration-300" id="modal-content">
            <div class="p-6">
                <div class="flex justify-between items-start mb-4">
                    <h3 id="modal-title" class="text-xl font-bold text-white">Title</h3>
                    <button onclick="closeModal()" class="text-slate-400 hover:text-white">&times;</button>
                </div>
                
                <div class="space-y-4">
                    <div class="bg-red-900/20 border border-red-900/50 p-4 rounded-lg">
                        <h4 class="text-xs font-bold text-red-400 uppercase mb-1">Respon "Terperdaya" (Ghurur)</h4>
                        <p id="modal-bad" class="text-sm text-slate-300">...</p>
                    </div>
                    
                    <div class="flex justify-center text-slate-500 text-xl">â¬‡ï¸ VS â¬‡ï¸</div>

                    <div class="bg-emerald-900/20 border border-emerald-900/50 p-4 rounded-lg">
                        <h4 class="text-xs font-bold text-emerald-400 uppercase mb-1">Respon Takwa (Haqqa Tuqatih)</h4>
                        <p id="modal-good" class="text-sm text-slate-300">...</p>
                    </div>
                </div>

                <div class="mt-6 pt-4 border-t border-slate-700">
                    <p id="modal-verse" class="text-xs text-amber-400 italic text-center">...</p>
                </div>
            </div>
            <button onclick="closeModal()" class="w-full bg-slate-700 hover:bg-slate-600 text-white py-3 font-bold transition">Tutup</button>
        </div>
    </div>

    <script>
        // --- DATA DALIL ---
        const dalilData = {
            1: {
                arab: `<p class="font-arabic text-2xl md:text-3xl text-amber-400 mb-4">ÙŠÙÙ°Ù“Ø£ÙÙŠÙ‘ÙÙ‡ÙØ§ Ù±Ù„Ù‘ÙØ°ÙÙŠÙ†Ù Ø¡ÙØ§Ù…ÙÙ†ÙÙˆØ§ÛŸ Ù±ØªÙ‘ÙÙ‚ÙÙˆØ§ÛŸ Ù±Ù„Ù„Ù‘ÙÙ‡Ù Ø­ÙÙ‚Ù‘Ù ØªÙÙ‚ÙØ§ØªÙÙ‡ÙÛ¦ ÙˆÙÙ„ÙØ§ ØªÙÙ…ÙÙˆØªÙÙ†Ù‘Ù Ø¥ÙÙ„Ù‘ÙØ§ ÙˆÙØ£ÙÙ†ØªÙÙ… Ù…Ù‘ÙØ³Ù’Ù„ÙÙ…ÙÙˆÙ†Ù</p>
                       <p class="text-slate-300 italic text-sm">"Wahai orang-orang yang beriman! Bertakwalah kepada Allah dengan sebenar-benar takwa kepada-Nya dan janganlah kamu mati kecuali dalam keadaan Muslim."</p>`,
                tajwid: `<p class="font-arabic text-2xl md:text-3xl text-white mb-4">...ÙˆÙÙ„ÙØ§ <span class="text-amber-400 border-b-2 border-amber-400">ØªÙÙ…ÙÙˆØªÙÙ†Ù‘Ù</span> Ø¥ÙÙ„Ù‘ÙØ§ ÙˆÙØ£ÙÙ†ØªÙÙ… <span class="text-amber-400 border-b-2 border-amber-400">Ù…Ù‘ÙØ³Ù’Ù„ÙÙ…ÙÙˆÙ†Ù</span></p>
                         <p class="text-slate-300 text-sm">Perhatikan <strong>Nun Tasydid</strong> dan <strong>Mim Tasydid</strong>. Ini adalah bacaan <span class="text-amber-400 font-bold">Gunnah</span>. Cara bacanya didengungkan (ditahan 2-3 harakat).</p>`,
                inti: `<div class="space-y-2 text-sm text-slate-300">
                        <p>âœ… <strong>Haqqa Tuqatih:</strong> Patuh total, selalu ingat Allah, dan bersyukur.</p>
                        <p>ğŸ›‘ <strong>Husnul Khotimah:</strong> Kita tidak tahu kapan mati, maka harus "Muslim" setiap detik agar saat dicabut nyawa dalam keadaan baik.</p>
                       </div>`
            },
            2: {
                arab: `<p class="font-arabic text-2xl md:text-3xl text-sky-300 mb-4">...ÙˆÙØ§Ø®Ù’Ø´ÙÙˆÙ’Ø§ ÙŠÙÙˆÙ’Ù…Ù‹Ø§ Ù„Ù‘ÙØ§ ÙŠÙØ¬Ù’Ø²ÙÙŠ ÙˆÙØ§Ù„ÙØ¯ÙŒ Ø¹ÙÙ† ÙˆÙÙ„ÙØ¯ÙÙ‡Ù... ÙÙÙ„ÙØ§ ØªÙØºÙØ±Ù‘ÙÙ†Ù‘ÙÙƒÙÙ…Ù Ø§Ù„Ù’Ø­ÙÙŠÙØ§Ø©Ù Ø§Ù„Ø¯Ù‘ÙÙ†Ù’ÙŠÙØ§...</p>
                       <p class="text-slate-300 italic text-sm">"...dan takutlah pada suatu hari yang (pada hari itu) seorang bapak tidak dapat menolong anaknya... maka janganlah sekali-kali kamu diperdaya oleh kehidupan dunia..."</p>`,
                mufrodat: `<div class="grid grid-cols-2 gap-2 text-sm text-left">
                            <div class="bg-slate-700 p-2 rounded"><strong>Ø§Ù„Ù’ØºÙØ±ÙÙˆØ±Ù</strong> : Penipu (Setan/Dunia)</div>
                            <div class="bg-slate-700 p-2 rounded"><strong>ÙˆÙØ§Ø®Ù’Ø´ÙÙˆÙ’Ø§</strong> : Dan takutlah kalian</div>
                            <div class="bg-slate-700 p-2 rounded"><strong>ÙˆÙØ§Ù„ÙØ¯ÙŒ</strong> : Orang tua (Ayah)</div>
                            <div class="bg-slate-700 p-2 rounded"><strong>ÙŠÙÙˆÙ’Ù…Ù‹Ø§</strong> : Hari (Kiamat)</div>
                           </div>`,
                inti: `<div class="space-y-2 text-sm text-slate-300">
                        <p>ğŸ‘¨â€ğŸ‘¦ <strong>Individual:</strong> Di akhirat, ayah tidak bisa tolong anak. Kita sendiri-sendiri.</p>
                        <p>ğŸ­ <strong>Tipuan Dunia:</strong> Jangan sampai main game, tidur, atau malas membuat kita lupa tugas utama (ibadah & belajar).</p>
                       </div>`
            }
        };

        function updateDalil(id, type) {
            document.getElementById(`dalil-${id}-content`).innerHTML = dalilData[id][type];
        }

        // --- CHART JS ---
        const ctx = document.getElementById('takwaRadar').getContext('2d');
        new Chart(ctx, {
            type: 'radar',
            data: {
                labels: ['Kepatuhan', 'Syukur', 'Dzikir (Ingat Allah)', 'Ihsan (Amal)', 'Akhlak Sosial'],
                datasets: [{
                    label: 'Profil Ideal Santri',
                    data: [100, 100, 100, 100, 100],
                    backgroundColor: 'rgba(56, 189, 248, 0.2)',
                    borderColor: '#38bdf8',
                    borderWidth: 2,
                    pointBackgroundColor: '#38bdf8'
                }, {
                    label: 'Tantangan Saat Ngantuk',
                    data: [60, 40, 30, 50, 70],
                    backgroundColor: 'rgba(251, 191, 36, 0.2)',
                    borderColor: '#fbbf24',
                    borderWidth: 2,
                    pointBackgroundColor: '#fbbf24'
                }]
            },
            options: {
                scales: {
                    r: {
                        angleLines: { color: 'rgba(255,255,255,0.1)' },
                        grid: { color: 'rgba(255,255,255,0.1)' },
                        pointLabels: { color: '#e2e8f0', font: {size: 11} },
                        ticks: { display: false }
                    }
                },
                plugins: {
                    legend: { labels: { color: '#e2e8f0' } }
                },
                maintainAspectRatio: false
            }
        });

        // --- TAJWID GAME ---
        let tajwidCount = 0;
        function checkTajwid(btn, isCorrect) {
            const feedback = document.getElementById('tajwid-feedback');
            const scoreDisplay = document.getElementById('tajwid-score');
            
            if (isCorrect) {
                if (!btn.classList.contains('bg-emerald-600')) {
                    btn.classList.remove('bg-slate-800', 'hover:bg-slate-700');
                    btn.classList.add('bg-emerald-600', 'border-emerald-400');
                    tajwidCount++;
                    scoreDisplay.innerText = tajwidCount;
                    feedback.innerHTML = `<span class="text-emerald-400">Benar! Itu bacaan Gunnah.</span>`;
                }
            } else {
                btn.classList.remove('bg-slate-800', 'hover:bg-slate-700');
                btn.classList.add('bg-red-900', 'border-red-600');
                feedback.innerHTML = `<span class="text-red-400">Salah. Itu bukan Nun/Mim Tasydid.</span>`;
            }
        }

        // --- SCENARIO MODAL ---
        const scenarios = {
            ngantuk: {
                title: "Ngantuk Berat Saat Ngaji",
                bad: "Tidur di pojokan. 'Ah, ustaz gak liat kok.' (Ghurur/Tertipu)",
                good: "Ambil air wudhu, niatkan 'Aku menahan kantuk ini demi Allah'. (Haqqa Tuqatih)",
                verse: "Ingat: Allah mengawasi (Ittaqillaha haitsuma kunta)"
            },
            uang: {
                title: "Nemu Uang 50 Ribu",
                bad: "Ambil buat jajan. 'Rezeki anak sholeh.' (Ghurur/Tertipu)",
                good: "Serahkan ke keamanan/ustaz. Takut makan harta haram. (Muraqabah)",
                verse: "Ingat: Di akhirat ayahmu tak bisa menolongmu jika kamu dituntut pemilik uang."
            },
            teman: {
                title: "Diajak Kabur Teman",
                bad: "Ikut kabur biar dibilang setia kawan. (Ghurur/Tertipu)",
                good: "Menolak halus & menasihati. 'Kita disini buat belajar, bro.' (Akhlak Mulia)",
                verse: "Ingat: Pergaulilah manusia dengan akhlak mulia."
            }
        };

        function openModal(key) {
            const data = scenarios[key];
            document.getElementById('modal-title').innerText = data.title;
            document.getElementById('modal-bad').innerText = data.bad;
            document.getElementById('modal-good').innerText = data.good;
            document.getElementById('modal-verse').innerText = data.verse;
            
            const modal = document.getElementById('modal-overlay');
            const content = document.getElementById('modal-content');
            modal.classList.remove('hidden');
            setTimeout(() => {
                content.classList.remove('scale-95', 'opacity-0');
                content.classList.add('scale-100', 'opacity-100');
            }, 10);
        }

        function closeModal() {
            const modal = document.getElementById('modal-overlay');
            const content = document.getElementById('modal-content');
            content.classList.remove('scale-100', 'opacity-100');
            content.classList.add('scale-95', 'opacity-0');
            setTimeout(() => {
                modal.classList.add('hidden');
            }, 300);
        }

        // --- QUIZ LOGIC (DATA FROM PREVIOUS TURNS) ---
        const questions = [
            {
                q: "Berdasarkan Q.S. Ali-Imran: 102, bagaimana seharusnya mukmin bertakwa?",
                opts: [
                    { t: "Sebenar-benar takwa (haqqa tuqatih)", c: true, r: "Ayat ini menuntut totalitas, bukan setengah-setengah." },
                    { t: "Sekadar menggugurkan kewajiban", c: false, r: "Takwa bukan formalitas." },
                    { t: "Hanya saat di masjid", c: false, r: "Takwa berlaku di mana saja." },
                    { t: "Sesuai sisa waktu luang", c: false, r: "Takwa adalah prioritas utama." }
                ]
            },
            {
                q: "Apa hukum bacaan pada kata 'ØªÙØºÙØ±Ù‘ÙÙ†Ù‘ÙÙƒÙÙ…Ù' (Taghurrannakum)?",
                opts: [
                    { t: "Gunnah (Didengungkan)", c: true, r: "Karena ada huruf Nun bertasydid." },
                    { t: "Izhar (Jelas)", c: false, r: "Izhar terjadi jika Nun Mati bertemu huruf Halqi." },
                    { t: "Mad Thabi'i", c: false, r: "Fokus utama di sini adalah tasydid pada Nun." },
                    { t: "Qalqalah", c: false, r: "Tidak ada huruf Qalqalah yang mati." }
                ]
            },
            {
                q: "Apa arti 'Al-Gharur' dalam Q.S. Luqman: 33?",
                opts: [
                    { t: "Penipu / Tipu Daya", c: true, r: "Dunia dan setan sering menipu manusia agar lalai." },
                    { t: "Maha Pengampun", c: false, r: "Itu Al-Ghaffar." },
                    { t: "Hari Pembalasan", c: false, r: "Itu Yaumul Jaza." },
                    { t: "Kemenangan", c: false, r: "Itu Al-Falah." }
                ]
            },
            {
                q: "Sikap 'Muraqabah' dalam takwa artinya...",
                opts: [
                    { t: "Merasa selalu diawasi Allah", c: true, r: "Ini mencegah kita berbuat dosa meski sendirian." },
                    { t: "Takut pada guru", c: false, r: "Ini takut pada makhluk." },
                    { t: "Mencari muka di depan orang", c: false, r: "Ini Riya'." },
                    { t: "Pasrah tanpa usaha", c: false, r: "Ini bukan tawakkal yang benar." }
                ]
            },
            {
                q: "Dalam Q.S. Luqman: 33, siapa yang tidak bisa menolong kita di kiamat?",
                opts: [
                    { t: "Orang tua (Bapak/Ibu)", c: true, r: "Hubungan darah putus saat hari pembalasan." },
                    { t: "Malaikat", c: false, r: "Malaikat menjalankan perintah Allah." },
                    { t: "Tetangga", c: false, r: "Fokus ayat ini pada hubungan terdekat (ayah-anak)." },
                    { t: "Guru", c: false, r: "Konteks ayat spesifik menyebut 'Walid' (Orang tua)." }
                ]
            },
            {
                q: "Hadis 'Ittaqillaha haitsuma kunta' menyuruh kita bertakwa di...",
                opts: [
                    { t: "Di mana saja kita berada", c: true, r: "Di asrama, di kelas, di WC, di pasar." },
                    { t: "Masjid saja", c: false, r: "Allah ada di mana-mana." },
                    { t: "Rumah saja", c: false, r: "Takwa tidak dibatasi dinding rumah." },
                    { t: "Bulan Ramadhan saja", c: false, r: "Takwa tidak dibatasi waktu." }
                ]
            },
             {
                q: "Apa arti lafal 'Waalidun' (ÙˆÙØ§Ù„ÙØ¯ÙŒ)?",
                opts: [
                    { t: "Orang tua / Bapak", c: true, r: "Isim Fa'il yang berarti orang yang melahirkan (bapak)." },
                    { t: "Anak", c: false, r: "Anak itu 'Walad'." },
                    { t: "Ibu", c: false, r: "Ibu itu 'Walidah' atau 'Umm'." },
                    { t: "Keluarga", c: false, r: "Keluarga itu 'Ahli'." }
                ]
            },
            {
                q: "Cara menghapus dosa kecil menurut hadis Nabi adalah...",
                opts: [
                    { t: "Mengikutinya dengan perbuatan baik", c: true, r: "Kebaikan akan menghapus keburukan." },
                    { t: "Melupakannya", c: false, r: "Dosa tidak hilang dengan dilupakan." },
                    { t: "Menceritakannya ke teman", c: false, r: "Dilarang membuka aib sendiri." },
                    { t: "Tidur", c: false, r: "Tidur tidak menghapus dosa." }
                ]
            },
             {
                q: "Kenapa kita dilarang mati kecuali sebagai Muslim?",
                opts: [
                    { t: "Karena kematian datang tiba-tiba", c: true, r: "Maka kita harus 'siaga' menjadi Muslim yang taat setiap saat." },
                    { t: "Karena mudah dilakukan", c: false, r: "Istiqamah itu berat." },
                    { t: "Agar bisa menunda ajal", c: false, r: "Ajal tidak bisa ditunda." },
                    { t: "Supaya kaya", c: false, r: "Tidak ada hubungannya dengan harta." }
                ]
            },
            {
                q: "Apa maksud 'Dunia adalah penipu'?",
                opts: [
                    { t: "Kesenangan dunia sering membuat lalai akhirat", c: true, r: "Game, main, tidur sering membuat lupa ngaji." },
                    { t: "Dunia ini palsu/ilusi", c: false, r: "Dunia nyata, tapi fana." },
                    { t: "Semua manusia pembohong", c: false, r: "Bukan manusianya, tapi sifat dunia." },
                    { t: "Kita harus membenci dunia", c: false, r: "Kita kelola dunia untuk akhirat, bukan membencinya." }
                ]
            }
        ];

        let currentQ = 0;
        let quizScore = 0;

        function loadQuestion() {
            const q = questions[currentQ];
            document.getElementById('question-number').innerText = `Soal ${currentQ + 1}/${questions.length}`;
            document.getElementById('progress-bar').style.width = `${((currentQ + 1) / questions.length) * 100}%`;
            document.getElementById('question-text').innerText = q.q;
            
            const grid = document.getElementById('answer-grid');
            grid.innerHTML = '';
            document.getElementById('rationale-box').classList.add('hidden');

            // Shuffle options
            const shuffled = [...q.opts].sort(() => Math.random() - 0.5);

            shuffled.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = 'w-full text-left p-4 rounded-xl bg-slate-700 hover:bg-slate-600 border border-slate-600 transition text-slate-200';
                btn.innerHTML = opt.t;
                btn.onclick = () => checkAnswer(opt, btn);
                grid.appendChild(btn);
            });
        }

        function checkAnswer(opt, btn) {
            // Disable all buttons
            const buttons = document.getElementById('answer-grid').children;
            for(let b of buttons) { b.disabled = true; b.classList.add('opacity-50'); }
            btn.classList.remove('opacity-50');

            const rationaleBox = document.getElementById('rationale-box');
            const rationaleTitle = document.getElementById('rationale-title');
            const rationaleText = document.getElementById('rationale-text');

            rationaleBox.classList.remove('hidden');

            if(opt.c) {
                btn.classList.remove('bg-slate-700', 'border-slate-600');
                btn.classList.add('bg-emerald-600', 'border-emerald-500');
                rationaleTitle.innerHTML = `<span class="text-emerald-400">Benar!</span>`;
                quizScore += 10;
                document.getElementById('quiz-score').innerText = quizScore;
            } else {
                btn.classList.remove('bg-slate-700', 'border-slate-600');
                btn.classList.add('bg-red-900', 'border-red-500');
                rationaleTitle.innerHTML = `<span class="text-red-400">Kurang Tepat.</span>`;
            }
            rationaleText.innerText = opt.r;
        }

        function nextQuestion() {
            currentQ++;
            if(currentQ < questions.length) {
                loadQuestion();
            } else {
                finishQuiz();
            }
        }

        function finishQuiz() {
            document.getElementById('quiz-container').classList.add('hidden');
            document.getElementById('quiz-end').classList.remove('hidden');
            document.getElementById('final-score').innerText = quizScore;
        }

        function restartQuiz() {
            currentQ = 0;
            quizScore = 0;
            document.getElementById('quiz-score').innerText = '0';
            document.getElementById('quiz-end').classList.add('hidden');
            document.getElementById('quiz-container').classList.remove('hidden');
            loadQuestion();
        }

        // Init
        loadQuestion();

    </script>
</body>
</html>